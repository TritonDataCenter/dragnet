#!/usr/bin/env node

/*
 * dn: create, query, and destroy indexes on data stored in Manta
 */

var mod_path = require('path');
var VError = require('verror');

var dnArg0 = mod_path.basename(process.argv[1]);
var dnCmds = {
    'index': cmdIndex,
    'destroy': cmdDestroy,
    'query': cmdQuery
};
var dnUsage = [
    'usage: dn index INDEX_CONFIG_FILE\n',
    '       dn destroy INDEX_NAME\n',
    '       dn query INDEX_NAME ...'
].join('');

function usage(err)
{
	if (err)
		console.error('%s: %s', dnArg0, err.message);

	console.error(dnUsage);
	process.exit(2);
}

function fatal(err)
{
	console.error('%s: %s', dnArg0, err.message);
	process.exit(1);
}

function main()
{
	var cmdname, cmdfunc;

	if (process.argv.length < 3)
		usage();

	cmdname = process.argv[2];
	if (!dnCmds.hasOwnProperty(cmdname))
		usage(new VError('no such command: "%s"', cmdname));

	cmdfunc = dnCmds[cmdname];
	cmdfunc(cmdname, process.argv.slice(3));
}

function cmdIndex(cmdname, argv)
{
	console.log('"%s" not yet implemented', cmdname);
}

function cmdDestroy(cmdname, argv)
{
	console.log('"%s" not yet implemented', cmdname);
}

function cmdQuery(cmdname, argv)
{
	console.log('"%s" not yet implemented', cmdname);
}


main();
